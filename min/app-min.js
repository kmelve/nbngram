$(document).ready(function(){function e(e){console.log(e.x_axis,e.y_axis,e.z_axis),console.log(e);var t=o(),a=e.ngram+"-"+e.corpus+"-"+t;console.log(a),$("#highcharts").append("<small>You can toggle the graphs by cliking their names in the legend.</small>"),n=new Highcharts.Chart({chart:{exporting:{filename:a},renderTo:"highcharts",type:"area",zoomType:"x"},title:{text:'NB Ngrams for "'+e.ngram+'" in '+e.corpus},subtitle:{text:"Source: nb.no/ngrams"},xAxis:[{categories:e.x_axis,crosshair:!0}],yAxis:[{floor:0,labels:{format:"{value} hits"},title:{text:"Absolute frequencies"},opposite:!0,showEmpty:!1},{floor:0,title:{text:"Relative frequencies"},labels:{format:"{value} %"},opposite:!1,showEmpty:!1}],tooltip:{shared:!0},legend:{layout:"vertical",align:"left",x:80,verticalAlign:"top",y:50,floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.legendBackgroundColor||"#FFFFFF"},series:[{name:"Relative frequencies",type:"area",yAxis:1,data:e.y_axis,marker:{enabled:!1},tooltip:{valueSuffix:" percent"}},{name:"Absolute frequencies",type:"line",yAxis:0,data:e.z_axis,marker:{enabled:!1},dashStyle:"shortdot",tooltip:{valueSuffix:" hits"}}]})}function t(e){var t=JSON.stringify(e,null,2);$("#results").append(str)}function a(e){var t="http://www.nb.no/sp_tjenester/beta/ngram_1/ngram/query?terms=",a="&lang=all&"+$("#search").serialize(),o=$("#text_input").val(),n=t+o+a;$.ajax({url:"proxy.php",type:"GET",dataType:"json",data:{searchquery:n}}).done(function(t){e(t.metadata)}).fail(function(e,t,a){console.log(e.status),console.log(a),console.log(searchquery),$("results").append("Something went wrong. Sorry!")}).always(function(){console.log("complete")})}function o(){var e=new Date,t=e.getDate(),a=e.getMonth()+1,o=e.getFullYear();return t+"-"+a+"-"+o}var n;$("#text_input").focus(),$("form").submit(function(t){t.preventDefault(),a(function(t){e(t)})})});